<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="../images/logo.ico">
    <link rel="stylesheet" href="https://pro.fontawesome.com/releases/v5.10.0/css/all.css"
        integrity="sha384-AYmEC3Yw5cVb3ZcuHtOA93w35dYTsvhLPVnYs9eStHfGJvOvKxVfELGroGkvsg+p" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
        integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"
        integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
    <link rel="stylesheet" href="../css/login.css">
    <link rel="stylesheet" href="../css/hover.css">
    <link rel="stylesheet" href="../css/scroll.css">
    <title>CLO</title>


</head>

<body class="all">

    <div class="container formulario">
        <div class="row">
            <div class="col-sm-9 col-md-7 col-lg-5 mx-auto">
                <div class="card card-signin my-5">
                    <div class="card-body">
                        <div class="backscreen hvr-backward">
                            <a href="../pages/user-profile.html">
                                <i class="fas fa-arrow-left"></i>
                            </a>
                        </div>
                        <div class="icone mb-2">
                            <h1 class="logo-clo mr-2" href="#">Clo</h1>
                            <img src="../images/logo.png" class="" height="50" alt="Logo Clo">
                        </div>
                        <p class="subtitle text-center text-monospace font">Editar Perfil Pessoal</p>
                        <form class="form-signin">
                            <div class="form-label-group">
                                <input type="text" id="nome" class="form-control text-dark"
                                    placeholder="Nome Completo" required autofocus>
                            </div>
                        
                            <!-- <div class="form-label-group">
                                <input type="text" id="inputEmail" class="form-control text-dark"
                                    placeholder="EndereÃ§o" required autofocus>
                            </div>

                            <div class="form-label-group">
                                <input type="text" id="inputEmail" class="form-control text-dark" placeholder="Complemento"
                                    required autofocus>
                            </div>

                            <div class="form-label-group">
                                <input type="text" id="inputEmail" class="form-control text-dark" placeholder="Email"
                                    required autofocus>
                            </div>

                            <div class="form-label-group">
                                <input type="text" id="inputEmail" class="form-control text-dark" placeholder="Telefone"
                                    required autofocus>
                            </div>

                            <hr class="my-4">

                            <div class="form-label-group">
                                <input type="file" id="inputPhoto" class="form-control inputphoto text-dark" required autofocus>
                                <label for="inputPhoto" class="form-control text-center">Adicionar Foto de Perfil</label>
                            </div> -->





                            <button class="btn btn-lg btn-login btn-block text-uppercase" type="submit">Salvar</button>



                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        var email1 = document.getElementById('email')
        
        
        var nome = document.getElementById("nome")
        // console.log(password)

        // var usuario = document.querySelector('.usuario')
        // var nome = document.querySelector(".nome")
        // var telefone = document.querySelector(".telefone")
        // var emailUser = document.querySelector(".email")	
            // console.log(password.value)
            document.addEventListener("DOMContentLoaded",function(){

            
            fetch(`http://localhost:3333/loadUser`,{
                method: "GET",
                headers: { 'Content-Type': 'application/json', 'Authorization': localStorage.getItem('token') }
            })
            .then((resposta) => {
                resposta.json().then((dados) => {
                    if(dados.message){
                        return window.location='404.html'
                    }
                    var { name, phone, email, password, street, numberHouse, complement } = dados;
                    nome.textContent = name
                   
                })
            })
        })

        form.addEventListener('submit', (e) => {
            e.preventDefault()

            // console.log(password.value)
            fetch(`http://localhost:3333/updateUser`, {
                method: "POST",
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    name: nome.value,
                })
            })
            .then((resposta) => {
                resposta.json().then((dados) => {
                    if(!dados.user){                      
                        return error.textContent = dados
                    }
                    var { name, phone, email, password, street, numberHouse } = dados.user;          
                        console.log(dados)
                        localStorage.setItem("token",dados.token)
                        window.location='user-profile.html'
                })
            })
        })
        

        

    </script>
</body>

</html>